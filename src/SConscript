import os

#set the sources
Import("env")

#compile the shared library - default behavior
sources = ["gridder.c"]
objects_env = env.SharedObject(sources)

if os.sys.platform == "linux2":
    env.Append(SHLINKFLAGS=['-Wl,-soname,%s'%'libxrayutilities.so' ] )

lib = env.SharedLibrary("xrayutilities",objects_env)
Default(lib)

#install the library
if os.sys.platform in ["darwin","linux2"]:
    Command("dummy","dummy",[Mkdir(os.path.join(env['DESTDIRPREFIX'],"lib"))])
    Alias("install",env.Install(os.path.join(env['DESTDIRPREFIX'],"lib"),lib[0]))
elif "win" in os.sys.platform:
    Command("dummy","dummy",[Mkdir(os.path.join(env['PREFIX'],"Lib"))])
    Alias("install",env.Install(os.path.join(env['PREFIX'],"Lib"),lib[0]))
